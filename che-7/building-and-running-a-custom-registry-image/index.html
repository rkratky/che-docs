<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=",  ">
<title>Building and running a custom registry image | Eclipse Che Documentation</title>
<link rel="stylesheet" href="/che-docs/css/syntax.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/che-docs/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="/che-docs/css/customstyles.css">
<link rel="stylesheet" href="/che-docs/css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="/che-docs/css/theme-che.css">


    <link rel="stylesheet" href="/che-docs/css/coderay.css" media="screen" type="text/css">
    <link rel="stylesheet" href="/che-docs/css/asciidoc.css" type="text/css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" crossorigin="anonymous"></script>
<script src="/che-docs/js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js" crossorigin="anonymous"></script>
<script src="/che-docs/js/toc.js"></script>
<script src="/che-docs/js/customscripts.js"></script>

<link rel="shortcut icon" href="/che-docs/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="che" href="/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: false,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="/che-docs/">&nbsp;<span class="projectTitle"> Eclipse Che Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://medium.com/eclipse-che-blog/" target="_blank">Blog</a></li>
                
                
                
                <li><a href="https://github.com/eclipse/che" target="_blank">Source Code</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Che Version<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="/che-docs/che-6">Che 6</a></li>
                        
                        
                        
                        <li class="dropdownActive"><a href="/che-docs/che-7">Che 7</a></li>
                        
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Support<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3Akind%2Fbug" target="_blank">Known Bugs</a></li>
                        
                        
                        
                        <li><a href="https://github.com/eclipse/che/issues/new" target="_blank">File an Issue</a></li>
                        
                        
                        
                        <li><a href="https://stackoverflow.com/questions/tagged/eclipse-che" target="_blank">Che on StackOverflow</a></li>
                        
                        
                    </ul>
                </li>
                
                
                <!-- 
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:?subject= feedback&body=I have some feedback about the Building and running a custom registry image page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>
 -->
		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/che-docs/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: "/che-docs/search.json",
                                searchResultTemplate: '<li><a href="{url}" title="Building and running a custom registry image">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Eclipse Che 7</li>
  
  <div class="sidebarSubtitle">Overview</div>
  
  
  <li>
      
      <a href="/che-docs/che-7/introduction-to-eclipse-che">Introduction to Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che quick-starts</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/che-quick-starts">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/installing-the-chectl-management-tool">Installing the chectl management tool</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/running-che-locally">Running Che locally</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/deploying-che-on-kubernetes-on-aws">Che on Amazon Web Services</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/installing-che-on-openshift-3-using-the-operator">Che on OpenShift 3</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/installing-che-on-openshift-4-from-operatorhub">Che on OpenShift 4</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/installing-che-on-google-cloud-platform">Che on Google Cloud Platform</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/installing-eclipse-che-on-microsoft-azure">Che on Microsoft Azure</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/hosted-che">Hosted Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che architecture</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/che-architecture">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/high-level-che-architecture">High-level Che architecture</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che-workspace-controller">Che workspace controller</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che-workspaces-architecture">Che workspaces architecture</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">End-user Guide</div>
  
  
  <li>
      
      <a href="/che-docs/che-7/navigating-che-using-the-dashboard">Navigating Che: dashboard</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che-Theia IDE basics</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/che-theia-ide-basics">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/defining-custom-commands-for-che-theia">Defining custom commands for Che-Theia</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/version-control">Version Control</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che-theia-troubleshooting">Che-Theia Troubleshooting</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Using developer workspaces</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/workspaces-overview">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/configuring-a-workspace-using-a-devfile">Configuring a workspace using a devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/making-a-workspace-portable-using-a-devfile">Making a workspace portable using a devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/converting-a-che-6-workspace-to-a-che-7-devfile">Converting a Che 6 Workspace to a Che 7 devfile</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/creating-and-configuring-a-new-che-7-workspace">Creating and configuring a new Che 7 workspace</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/importing-a-kubernetes-application-into-a-che-workspace">Importing a Kubernetes application into a Che workspace</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/remotely-accessing-che-workspaces">Remotely accessing workspaces</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/creating-a-workspace-from-code-sample">Creating a workspace from code sample</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/creating-a-workspace-by-importing-source-code-of-a-project">Creating a workspace by importing source code of a project</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/configuring-workspace-exposure-strategies">Configuring workspace exposure strategies</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Customizing developer environments</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/customizing-developer-environments">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/what-is-a-che-theia-plug-in">What is a Che-Theia plug-in</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/using-alternative-ides-in-che">Using alternative IDEs in Che</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/using-a-visual-studio-code-extension-in-che">Using a VS Code extension in Che</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Installation Guide</div>
  
  
  <li>
      
      <a href="/che-docs/che-7/updating-che">Updating Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/advanced-configuration-options">Advanced configuration options</a>
      
      <ul>
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Administration Guide</div>
  
  
  <li>
      
      <a href="#" class="expandable">Customizing devfile and plug-in registries</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/customizing-the-devfile-and-plug-in-registries">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/building-and-running-a-custom-registry-image">Building and running a custom registry image</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/including-the-plug-in-binaries-in-the-registry-image">Including the plug-in binaries in the registry image</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/editing-a-devfile-and-plug-in-at-runtime">Editing a devfile and plug-in at runtime</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Retrieving Che logs</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/retrieving-che-logs">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/viewing-kubernetes-events">Viewing Kubernetes events</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/viewing-che-server-logs">Viewing Che server logs</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/viewing-external-service-logs">Viewing external service logs</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/viewing-che-workspaces-logs">Viewing Che workspaces logs</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/viewing-plug-in-broker-logs">Viewing the plug-in broker logs</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/monitoring-che">Monitoring Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/tracing-che">Tracing Che</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Securing Che</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/securing-che">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/authenticating-users">Authenticating users</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/authorizing-users">Authorizing users</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Contributor Guide</div>
  
  
  <li>
      
      <a href="/che-docs/che-7/developing-che-theia-plug-ins">Developing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/testing-che-theia-plug-ins">Testing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/publishing-che-theia-plug-ins">Publishing Che-Theia plug-ins</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/adding-support-for-a-new-language">Adding support for a new language</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="/che-docs/che-7/adding-support-for-a-new-debugger">Adding support for a new debugger</a>
      
      <ul>
          
      </ul>
   </li>
     
      
  
  <li>
      
      <a href="#" class="expandable">Che extensibility reference</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/che-extensibility-reference">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che-extension-points">Che extension points</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che-theia-plug-in-api">Che-Theia plug-in API</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/debug-adapter-protocol">Debug Adapter Protocol</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/language-server-protocol">Language Server Protocol</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
  <div class="sidebarSubtitle">Extensions</div>
  
  
  <li>
      
      <a href="#" class="expandable">Eclipse Che4z</a>
      
      <ul>
          
          
          
          <li><a href="/che-docs/che-7/eclipse-che4z">Overview</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che4z-release-information">Release Information</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che4z-installing">Installing</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che4z-using-explorer-for-zos">Using z/OS Resource Explorer</a></li>
          
          
          
          
          
          
          <li><a href="/che-docs/che-7/che4z-product-accessibility-features">Product Accessibility Features</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block: -->
         <p class="external">
             <a href="#" id="collapseAll">Collapse all</a> | <a href="#" id="expandAll">Expand all</a>
         </p>
         
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>

            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Building and running a custom registry image</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.
$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2' });
/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top
  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    


    <!-- 


     -->

  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the building of registries and updating a running Che server to point to the registries.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cloning-the-registries">Cloning the registries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes how to clone the devfile and plug-in registries.</p>
</div>
<div class="sect2">
<h3 id="cloning-the-plug-in-registry_cloning-the-registries">Cloning the plug-in registry</h3>
<div class="paragraph">
<p>This section describes how to clone the <strong>che-plugin-registry</strong> Git repository.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ git clone git@github.com:eclipse/che-plugin-registry.git</pre>
</div>
</div>
</li>
<li>
<p>Verify the repository has been cloned.</p>
<div class="listingblock">
<div class="content">
<pre>$ tree -L 2 ./che-plugin-registry
./che-plugin-registry
(...)
├── Dockerfile   <i class="conum" data-value="1"></i><b>(1)</b>
├── README.md    <i class="conum" data-value="2"></i><b>(2)</b>
├── kubernetes   <i class="conum" data-value="3"></i><b>(3)</b>
├── openshift    <i class="conum" data-value="4"></i><b>(4)</b>
├── plugins      <i class="conum" data-value="5"></i><b>(5)</b>
├── v2           <i class="conum" data-value="6"></i><b>(6)</b>
└── v3           <i class="conum" data-value="7"></i><b>(7)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Dockerfile to build the container image</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Updated instructions to build and run the registry</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Kubernetes deployment files</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>OpenShift deployment files</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Plug-in folder</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Deprecated plug-in folder that may be removed in the future</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Deprecated plug-in folder that may be removed in the future</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="cloning-the-devfile-registry_cloning-the-registries">Cloning the devfile registry</h3>
<div class="paragraph">
<p>This section describes how to clone the <strong>che-devfile-registry</strong> Git repository.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ git clone git@github.com:eclipse/che-devfile-registry.git</pre>
</div>
</div>
</li>
<li>
<p>Verify the repository has been cloned.</p>
<div class="listingblock">
<div class="content">
<pre>$ tree -L 2 ./che-devfile-registry
./che-devfile-registry
(...)
├── Dockerfile             <i class="conum" data-value="1"></i><b>(1)</b>
├── README.md              <i class="conum" data-value="2"></i><b>(2)</b>
├── arbitrary-users-patch  <i class="conum" data-value="3"></i><b>(3)</b>
├── deploy
│ ├── kubernetes           <i class="conum" data-value="4"></i><b>(4)</b>
│ └── openshift            <i class="conum" data-value="5"></i><b>(5)</b>
└── devfiles               <i class="conum" data-value="6"></i><b>(6)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Dockerfile to build the container image</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Updated instructions to build and run the registry</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Scripts to patch images so that they work fine even if run as arbitrary users</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Kubernetes deployment files</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>OpenShift deployment files</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Devfiles folder</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="modifying-the-registries">Modifying the registries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section explains how to modify the existing content of the devfile and plug-in registries: the devfiles and plug-in metadata.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The registries are cloned following the <a href="/che-docs/che-7/customizing-the-devfile-and-plug-in-registries">Cloning the registries</a> procedure.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="adding-a-new-plug-in_modifying-the-registries">Adding a new plug-in</h3>
<div class="paragraph">
<p>The <code>v3/plugins/</code> directory in the repository contains the plug-ins. The following is the structure of a plug-in directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./che-plugin-registry/v3/plugins
 ├── <em>&lt;publisher&gt;</em>
 ├── <em>&lt;plugin-name&gt;</em>
 ├── <em>&lt;plugin-version&gt;</em>
 └── meta.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>To add a new plug-in:</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <code>v3/plugins/</code> directory, create a new directory and name it <code><em>&lt;publisher&gt;</em>/<em>&lt;plugin-name&gt;</em>/<em>&lt;plugin-version&gt;</em>/</code>.</p>
</li>
<li>
<p>Create a plug-in <code>meta.yaml</code> file in the new directory.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Example</div>
<div class="paragraph">
<p>The following is an example directory called <code>my-org/my-plugin/1.0.0/</code>, and it contains a meta.yaml file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir -p che-plugin-registry/v3/plugins/my-org/my-plugin/1.0.0/
$ touch che-plugin-registry/v3/plugins/my-org/my-plugin/1.0.0/meta.yaml
$ tree ./che-plugin-registry/v3/plugins
./che-plugin-registry/v3/plugins
 ├── my-org
 ├── my-plugin
 ├── 1.0.0
 └── meta.yaml</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Add valid content to the <code>meta.yaml</code> file. See the “Using a Visual Studio Code extension in Che” section or the README.md file in the <code>eclipse/che-plugin-registry</code> repository for a detailed description of the <code>meta.yaml</code> file format.</p>
</li>
<li>
<p>Create a directory called <code>latest/</code> and copy the <code>meta.yaml</code> file in it, too. The <code>meta.yaml</code> file in the <code>latest/</code> directory is used when the plug-in version is not specified (in a devfile, for example).</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The <code>latest/</code> directory should always contain a copy of the latest stable <code>meta.yaml</code> file.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Example</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir che-plugin-registry/v3/plugins/my-org/my-plugin/latest/
$ copy che-plugin-registry/v3/plugins/my-org/my-plugin/1.0.0/meta.yaml \
che-plugin-registry/v3/plugins/my-org/my-plugin/latest
$ tree ./che-plugin-registry/v3/plugins
./che-plugin-registry/v3/plugins
 ├── my-org
 ├── my-plugin
 ├── 1.0.0
 ├── meta.yaml
 ├── latest
 └── meta.yaml</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="adding-a-new-devfile_modifying-the-registries">Adding a new devfile</h3>
<div class="paragraph">
<p>The <code>devfiles/</code> directory contains the devfiles. Every devfile directory has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./che-devfile-registry/devfiles
 ├── <em>&lt;stack-name&gt;</em>
 ├── devfile.yaml
 └── meta.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>To add a new devfile:</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <code>devfiles/</code> directory, create a new subdirectory <code><em>&lt;stack-name&gt;</em>/</code>.</p>
</li>
<li>
<p>In this new subdirectory, add a new plug-in <code>devfile.yaml</code> file and a <code>meta.yaml</code> file. The following is an example <code>my-stack/</code> directory, and it contains a <code>devfile.yaml</code> file and a <code>meta.yaml</code> file:</p>
<div class="listingblock">
<div class="content">
<pre>$ mkdir -p che-devfile-registry/devfiles/my-devfile
$ touch che-devfile-registry/devfiles/my-devfile/devfile.yaml
$ touch che-devfile-registry/devfiles/my-devfile/meta.yaml
$ tree ./che-devfile-registry/devfiles
./che-devfile-registry/devfiles
 ├── my-devfile
 ├── devfile.yaml
 └── meta.yaml</pre>
</div>
</div>
</li>
<li>
<p>Add valid content in the <code>devfile.yaml</code> file. For a detailed description of the devfile format, see the <a href="/che-docs/che-7/making-a-workspace-portable-using-a-devfile">Making a workspace portable using a Devfile</a> section.</p>
</li>
<li>
<p>Ensure that the <code>meta.yaml</code> file conforms to the following structure:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">displayName</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">My Stack                                        </span></span><i class="conum" data-value="1"></i><b>(1)</b>
<span style="color:#606">description</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">This is a custom stack for Che                  </span></span><i class="conum" data-value="2"></i><b>(2)</b>
<span style="color:#606">tags</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">[&quot;Java&quot;, &quot;maven&quot;, &quot;ubi&quot;]                               </span></span><i class="conum" data-value="3"></i><b>(3)</b>
<span style="color:#606">icon</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">https://www.eclipse.org/che/images/logo-eclipseche.svg </span></span><i class="conum" data-value="4"></i><b>(4)</b>
<span style="color:#606">globalMemoryLimit</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1686Mi                                    </span></span><i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Name of the stack as it appears on the user dashboard.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Description of the stack as it appears on the user dashboard.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Tags of the stack. Tags usually include the tools included in the stack.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The link to an <code>.svg</code> file that is displayed on the user dashboard.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The sum of the memory limits of all the components of the stack. This number will be visible on the user dashboard. It is informative and is not taken into account by the Che server.</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building-the-images-of-the-registries">Building the images of the registries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Dockerfiles to build the registries are in the root directory of the respective GitHub repository.</p>
</div>
<div class="sect2">
<h3 id="building-the-images-of-the-plug-in-registry_building-the-images-of-the-registries">Building the images of the plug-in registry</h3>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Run the following command</p>
<div class="listingblock">
<div class="content">
<pre>$ docker build -t my-plugin-registry ./che-plugin-registry/</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="building-the-images-of-the-devfile-registry_building-the-images-of-the-registries">Building the images of the devfile registry</h3>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Run the following command</p>
<div class="listingblock">
<div class="content">
<pre>$ docker build -t my-devfile-registry ./che-devfile-registry</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-the-registries">Deploying the registries</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>The <code>my-plugin-registry</code> and <code>my-devfile-registry</code> images used in this section are built using the <code>docker</code> command. This section assumes that these images are available on the Kubernetes and OpenShift cluster where Che is deployed.</p>
</div>
<div class="paragraph">
<p>This is true on Minishift or Minikube, for example, if before running the <code>docker build</code> commands, the user executed the <code>eval $\{minikube docker-env}</code> command (or, the <code>eval $\{minishift docker-env}</code> command for Minishift).</p>
</div>
<div class="paragraph">
<p>Otherwise, these images can be pushed to a container registry (public, such as <code>quay.io</code>, or the DockerHub, or a private registry).</p>
</div>
<div class="sect2">
<h3 id="deploying-registries-in-kubernetes_deploying-the-registries">Deploying registries in Kubernetes</h3>
<div class="paragraph">
<div class="title">Procedure</div>
<p>A Helm chart for the plug-in registry is available in the <code>/kubernetes/che-plugin-registry/</code> directory of the GitHub repository.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To deploy the plug-in registry using the Helm chart, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>NAMESPACE=<em>&lt;namespace-name&gt;</em>     <i class="conum" data-value="1"></i><b>(1)</b>
DOMAIN=<em>&lt;kubernetes-cluster-domain&gt;</em> <i class="conum" data-value="2"></i><b>(2)</b>
IMAGE="my-plugin-registry"
helm upgrade --install che-plugin-registry \
 --debug \
 --namespace $\{NAMESPACE} \
 --set global.ingressDomain=$\{DOMAIN} \
 --set chePluginRegistryImage=$\{IMAGE} \
 --set chePluginRegistryImagePullPolicy="IfNotPresent" \
 ./kubernetes/che-plugin-registry/</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The default Che namespace is <code>che</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>On Minikube, use <code>$(minikube ip).nip.io</code></td>
</tr>
</table>
</div>
</li>
<li>
<p>The devfile registry also has a Helm chart in the <code>deploy/kubernetes/che-devfile-registry/</code> directory of the GitHub repository. To deploy it, run the command:</p>
<div class="listingblock">
<div class="content">
<pre>NAMESPACE=<em>&lt;namespace-name&gt;</em>     <i class="conum" data-value="1"></i><b>(1)</b>
DOMAIN=<em>&lt;kubernetes-cluster-domain&gt;</em> <i class="conum" data-value="2"></i><b>(2)</b>
IMAGE="my-devfile-registry"
helm upgrade --install che-devfile-registry \
 --debug \
 --namespace $\{NAMESPACE} \
 --set global.ingressDomain=$\{DOMAIN} \
 --set cheDevfileRegistryImage=$\{IMAGE} \
 --set cheDevfileRegistryImagePullPolicy="IfNotPresent" \
 ./deploy/kubernetes/che-devfile-registry/</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The default Che namespace is <code>che</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>On Minikube, use <code>$(minikube ip).nip.io</code></td>
</tr>
</table>
</div>
</li>
<li>
<p>The Helm chart creates a pod, a service, and an Ingress. To get them, use <code>app=che-plugin-registry</code> (or <code>app=che-plugin-registry</code> for the devfile registry).</p>
<div class="listingblock">
<div class="content">
<pre>$ kubectl get -o custom-columns=TYPE:.kind,NAME:.metadata.name \
  -l app=che-plugin-registry pod,svc,ingress
TYPE      NAME
Pod       che-plugin-registry-5c7cd8d5c9-zlqlz
Service   che-plugin-registry
Ingress   che-plugin-registry</pre>
</div>
</div>
</li>
<li>
<p>To verify that the new plug-in is correctly published to the plug-in registry, make a request to the registry path <code>/v3/plugins/index.json</code> (or <code>/devfiles/index.json</code> for the devfile registry).</p>
<div class="listingblock">
<div class="content">
<pre>$ URL=$(kubectl get -o 'custom-columns=URL:.spec.rules[0].host' \
  -l app=che-plugin-registry ingress --no-headers)
$ INDEX_JSON=$(curl -sSL http://$\{URL}/v3/plugins/index.json)
$ echo $\{INDEX_JSON} | grep -A 4 -B 5 "\"name\":\"my-plugin\""
,\{
 "id": "my-org/my-plugin/1.0.0",
 "displayName":"This is my first Che plugin",
 "version":"1.0.0",
 "type":"VS Code extension",
 "name":"my-plugin",
 "description":"This plugins shows that we are able to add plugins to the registry...",
 "publisher":"my-org",
 "links": \{"self":"/v3/plugins/my-org/my-plugin/1.0.0" }
}
--
--
,\{
 "id": "my-org/my-plugin/latest",
 "displayName":"This is my first Che plugin",
 "version":"latest",
 "type":"VS Code extension",
 "name":"my-plugin",
 "description":"This plugins shows that we are able to add plugins to the registry...",
 "publisher":"my-org",
 "links": \{"self":"/v3/plugins/my-org/my-plugin/latest" }
}</pre>
</div>
</div>
</li>
<li>
<p>Verify that the Che server points to the URL of the registry. To do this, compare the value of the <code>CHE_WORKSPACE_PLUGIN__REGISTRY__URL</code> parameter in the <code>che</code> ConfigMap (or <code>CHE_WORKSPACE_DEVFILE__REGISTRY__URL</code> for the devfile registry):</p>
<div class="listingblock">
<div class="content">
<pre>$ kubectl get \
  -o "custom-columns=URL:.data['CHE_WORKSPACE_PLUGIN__REGISTRY__URL']" \
  --no-headers cm/che
URL
http://che-plugin-registry-che.192.168.99.100.nip.io/v3</pre>
</div>
</div>
<div class="paragraph">
<p>with the URL of the Ingress:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ kubectl get -o 'custom-columns=URL:.spec.rules[0].host' \
  -l app=che-plugin-registry ingress --no-headers
che-plugin-registry-che.192.168.99.100.nip.io</pre>
</div>
</div>
</li>
<li>
<p>If they do not match, update the ConfigMap and restart the Che server.</p>
<div class="listingblock">
<div class="content">
<pre>$ kubectl edit cm/che
(...)
$ kubectl scale --replicas=0 deployment/che
$ kubectl scale --replicas=1 deployment/che</pre>
</div>
</div>
<div class="paragraph">
<p>When the new registries are deployed and the Che server is configured to use them, the new plug-ins are available in the <strong>Plugin</strong> view of a workspace.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/che/docs/images/customization/deploying-plugin-registry-in-kubernetes.png" alt="deploying plugin registry in kubernetes">
</div>
</div>
<div class="paragraph">
<p>The new stacks are displayed in the <strong>New Workspace</strong> tab of the user dashboard.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/che/docs/images/customization/deploying-devfile-registry-in-kubernetes.png" alt="deploying devfile registry in kubernetes">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="deploying-registries-in-openshift_deploying-the-registries">Deploying registries in OpenShift</h3>
<div class="paragraph">
<div class="title">Procedure</div>
<p>An OpenShift template to deploy the plug-in registry is available in the <code>openshift/</code> directory of the GitHub repository.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To deploy the plug-in registry using the OpenShift template, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>NAMESPACE=<em>&lt;namespace-name&gt;</em>  <i class="conum" data-value="1"></i><b>(1)</b>
IMAGE_NAME="my-plugin-registry"
IMAGE_TAG="latest"
oc new-app -f openshift/che-plugin-registry.yml \
 -n "$\{NAMESPACE}" \
 -p IMAGE="$\{IMAGE_NAME}" \
 -p IMAGE_TAG="$\{IMAGE_TAG}" \
 -p PULL_POLICY="IfNotPresent"</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The default Che namespace is <code>che</code>.</td>
</tr>
</table>
</div>
</li>
<li>
<p>The devfile registry has an OpenShift template in the <code>deploy/openshift/</code> directory of the GitHub repository. To deploy it, run the command:</p>
<div class="listingblock">
<div class="content">
<pre>NAMESPACE=<em>&lt;namespace-name&gt;</em>  <i class="conum" data-value="1"></i><b>(1)</b>
IMAGE_NAME="my-devfile-registry"
IMAGE_TAG="latest"
oc new-app -f openshift/che-devfile-registry.yml \
 -n "$\{NAMESPACE}" \
 -p IMAGE="$\{IMAGE_NAME}" \
 -p IMAGE_TAG="$\{IMAGE_TAG}" \
 -p PULL_POLICY="IfNotPresent"</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The default Che namespace is <code>che</code>.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Check if the registries are deployed successfully on OpenShift. The steps to check are similar to the Kubernetes steps. For details, see the <a href="#deploying-registries-in-kubernetes_deploying-the-registries">Deploying registries in Kubernetes</a> section. The only difference is that, on OpenShift, Ingresses are replaced with routes.</p>
</li>
</ol>
</div>
</div>
</div>
</div>

    <div class="tags">
        
        <b>Tags: </b>
        
        
        
    </div>

<!-- 
 -->

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                    Eclipse Che - Documentation <br/>
                    Site last generated: Nov 29, 2019 <br/>
                    <hr>
                    <a href="http://www.eclipse.org" target="_blank">Eclipse Foundation</a><br/>
                    <a href="http://www.eclipse.org/legal/privacy.php" target="_blank">Privacy Policy</a><br/>
                    <a href="http://www.eclipse.org/legal/termsofuse.php" target="_blank">Terms of Use</a><br/>
                    <a href="https://www.eclipse.org/legal/epl-2.0/" target="_blank">Eclipse Public License</a><br/>
                    <a href="http://www.eclipse.org/legal" target="_blank">Legal Resources</a><br/>
                </div>
            </div>
</footer>




    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
